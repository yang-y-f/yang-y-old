# 设计文档（UI/交互/算法）

## UI 导航

- 相机页（默认）：预览取景，底部拍照按钮；右上角进入设置
- 结果页：展示识别文本（可扩展为卡片/图片+标签）
- 设置页：配置服务器基础地址（HTTP/HTTPS）

## 状态与交互

- 托盘检测状态：未检测/已检测，影响拍照按钮可用态
- 拍照后立即上传，显示进度指示
- 上传成功返回 `requestId` 后跳转到结果页
- 结果页拉取并显示识别内容；失败时提示并允许返回

## 托盘检测（占位实现）

- 当前采用简化逻辑：基于 `ImageAnalysis` 的帧回调，仅判断裁剪区域有效即视为“检测到托盘”
- 可替换为：
  - MLKit Object Detection / Custom Model（TFLite）
  - 边缘检测 + 颜色/形状先验

## 网络协议

- `POST /recognize`：`multipart/form-data`，字段名 `image`
- `GET /result/{id}`：返回识别结果字符串（或结构化 JSON）

## 错误处理

- 相机权限拒绝：显示提示并提供重新申请入口
- 网络失败：Toast/对话框提示，并支持重试
- 结果为空：展示占位文案和“返回”按钮

## 性能与功耗

- `ImageAnalysis` 使用 `STRATEGY_KEEP_ONLY_LATEST` 降低堆积
- 上传前可按需压缩 JPEG，控制分辨率与体积
- 结果页可增加超时与取消逻辑